{% extends 'index.html' %}

{% block content %}
<form method="post" class="ui form" style="margin-top: 55px;">
{% csrf_token %}
    <div class="ui orange segment" id="segment_create_trial">
        <h3 class="ui dividing header">Изменение испытания образца {{ trials.sample }}</h3>

        <div class="three fields">
            <div class="field">
                <label for="id_size_particle">Размер частицы</label>
                <input type="text" placeholder="Введите данные" name="size_particle" id="id_size_particle"
                value="{% if trials.size_particle.value %}{{ trials.size_particle.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_speed_collision">Cкорость соударения</label>
                <input type="text" placeholder="Введите данные" name="speed_collision" id="id_speed_collision"
                value="{% if trials.speed_collision.value %}{{ trials.speed_collision.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_corner_collision">Угол соударения</label>
                <input type="text" placeholder="Введите данные" name="corner_collision" id="id_corner_collision"
                value="{% if trials.corner_collision.value %}{{ trials.corner_collision.value }}{% endif %}">
            </div>
        </div>

        <div class="three fields">
            <div class="field">
                <label for="id_flow_type">Тип потока</label>
                <input type="text" placeholder="Введите данные" name="flow_type" id="id_flow_type"
                value="{% if trials.flow_type.value %}{{ trials.flow_type.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_chamber_pressure">Давление в камере</label>
                <input type="text" placeholder="Введите данные" name="chamber_pressure" id="id_chamber_pressure"
                value="{% if trials.chamber_pressure.value %}{{ trials.chamber_pressure.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_sample_temp">Температура образца</label>
                <input type="text" placeholder="Введите данные" name="sample_temp" id="id_sample_temp"
                value="{% if trials.sample_temp.value %}{{ trials.sample_temp.value }}{% endif %}">
            </div>
        </div>

        <div class="three fields">
            <div class="field">
                <label for="id_abrasive_type">Тип абразива</label>
                <input type="text" placeholder="Введите данные" name="abrasive_type" id="id_abrasive_type"
                value="{% if trials.abrasive_type.value %}{{ trials.abrasive_type.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_air_consumption">Расход воздуха</label>
                <input type="text" placeholder="Введите данные" name="air_consumption" id="id_air_consumption"
                value="{% if trials.air_consumption.value %}{{ trials.air_consumption.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_abrasive_consumption">Расход абразива</label>
                <input type="text" placeholder="Введите данные" name="sample_temp" id="id_abrasive_consumption"
                value="{% if trials.abrasive_consumption.value %}{{ trials.abrasive_consumption.value }}{% endif %}">
            </div>
        </div>

        <div class="two fields">
            <div class="field">
                <label for="id_nozzle_diam">Диаметр сопла</label>
                <input type="text" placeholder="Введите данные" name="nozzle_diam" id="id_nozzle_diam"
                value="{% if trials.nozzle_diam.value %}{{ trials.nozzle_diam.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_distance_sub">Расстояние от сопла до образца</label>
                <input type="text" placeholder="Введите данные" name="distance_sub" id="id_distance_sub"
                value="{% if trials.distance_sub.value %}{{ trials.distance_sub.value }}{% endif %}">
            </div>
        </div>

        <div class="two fields">
            <div class="field">
                <label for="id_type_particle">Тип частиц</label>
                <input type="text" placeholder="Введите данные" name="type_particle" id="id_type_particle"
                value="{% if trials.type_particle.value %}{{ trials.type_particle.value }}{% endif %}">
            </div>
            <div class="field">
                <label for="id_add_param">Параметры</label>
                <input type="text" placeholder="Введите данные" name="add_param" id="id_add_param"
                value="{% if trials.add_param.value %}{{ trials.add_param.value }}{% endif %}">
            </div>
        </div>

        <div class="two fields">
            <div class="field">
                <label for="id_date_trials">Дата начала испытаний</label>
                <div class="ui calendar" id="rangestart">
                    <div class="ui input left icon">
                        <i class="calendar icon"></i>
                        <input type="text" placeholder="Выберите дату" name="date_trials" id="id_date_trials"
                        value="{% if trials.date_trials.value %}{{ trials.date_trials.value }}{% endif %}">
                    </div>
                </div>
            </div>
            <div class="field">
                <label for="id_date_end_trials">Дата окончания испытаний</label>
                <div class="ui calendar" id="rangeend">
                    <div class="ui input left icon">
                        <i class="calendar icon"></i>
                        <input type="text" placeholder="Выберите дату" name="date_end_trials" id="id_date_end_trials"
                        value="{% if trials.date_end_trials.value %}{{ trials.date_end_trials.value }}{% endif %}">
                    </div>
                </div>
            </div>
        </div>

        <div class="field">
            <label for="id_description">Описание параметров работы стенда</label>
            <textarea type="text" placeholder="" name="description" id="id_description">{% if trials.description.value %}{{ trials.description.value }}{% endif %}
            </textarea>
        </div>

        <div class="three fields">
            <div class="field">
                <label>Образец</label>
                <select name="sample" class="ui fluid search dropdown" id="id_sample">
                    {% for value in sample %}
                        <option {% if value.id == trials.sample.id %}selected{% endif %} value="{{ value.id }}" id="id_sample_{{ value.id }}">{{ value }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="field" style="display: none;">
                {{ form.author }}
            </div>
        </div>

    <div class="ui aligned grid">
        <div class="right aligned sixteen wide column">
            <button class='ui red button' formaction="{% url 'trial:delete' trials.pk %}" type="submit" value="DELETE">Удалить</button>
            <button class='ui orange button' type="submit" value="Update">Сохранить</button>
        </div>
    </div>



    </div>
</form>
{% endblock content %}

{% block scripts %}
<script>

$('.ui.form')
    .form({
        on: 'blur',
        inline : true,
        fields: {
            size_particle: {
                identifier: 'size_particle',
                rules: [
                    {
                        type: 'number',
                        prompt: 'Это числовая характеристика! Например: 0.234'
                    },
                ]
            },
            speed_collision: {
                identifier: 'speed_collision',
                rules: [
                    {
                        type: 'number',
                        prompt: 'Это числовая характеристика! Например: 0.234'
                    },
                ]
            },
            corner_collision: {
                identifier: 'corner_collision',
                rules: [
                    {
                        type: 'number',
                        prompt: 'Это числовая характеристика! Например: 0.234'
                    },
                ]
            },
            sample: {
                identifier: 'sample',
                rules: [
                    {
                        type: 'empty',
                        prompt: 'Обязательное поле! Выберите образец'
                    },
                ]
            },
        }
    });

$('#rangestart').calendar({
    type: 'date',
    centuryBreak: 0,
    formatter: {
        date: function (date, settings) {
            if (!date) return '';
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();
            return year + '-' + month + '-' + day;
        }
    },
    endCalendar: $('#rangeend')
});

$('#rangeend').calendar({
    type: 'date',
    centuryBreak: 0,
    formatter: {
        date: function (date, settings) {
            if (!date) return '';
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();
            return year + '-' + month + '-' + day;
        }
    },
    startCalendar: $('#rangestart')
});

$(' .ui.dropdown')
  .dropdown({
    allowAdditions: true
  })
;

</script>
{% endblock scripts %}

